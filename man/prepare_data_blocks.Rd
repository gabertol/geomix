% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/preprocessing.R
\name{prepare_data_blocks}
\alias{prepare_data_blocks}
\title{Prepare Multiple Data Blocks for Unmixing}
\usage{
prepare_data_blocks(
  kde_raw = NULL,
  point_counting_raw = NULL,
  compositional_raw = NULL,
  other_raw = NULL,
  kde_vars = NULL,
  point_counting_vars = NULL,
  compositional_vars = NULL,
  n_points_kde = 129,
  apply_clr_point_counting = FALSE,
  apply_clr_compositional = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{kde_raw}{Data frame or named list of data frames with KDE data
(e.g., detrital zircon ages). Optional.}

\item{point_counting_raw}{Data frame or named list of data frames with
point counting data (discrete counts). Optional.}

\item{compositional_raw}{Data frame or named list of data frames with
compositional data (already proportions). Optional.}

\item{other_raw}{Named list of additional data frames (optional)}

\item{kde_vars}{Character vector or named list of character vectors for KDE variables.
If a single vector, applies to all KDE blocks. If named list, must match names in kde_raw.}

\item{point_counting_vars}{Character vector or named list for point counting variables.}

\item{compositional_vars}{Character vector or named list for compositional variables.}

\item{n_points_kde}{Number of bins for KDE discretization (default: 129).
Can be a single value or named list matching kde_raw.}

\item{apply_clr_point_counting}{Apply CLR to point counting? (default: FALSE).
Can be single logical or named list.}

\item{apply_clr_compositional}{Apply CLR to compositional? (default: FALSE).
Can be single logical or named list.}

\item{verbose}{Print progress messages? (default: TRUE)}
}
\value{
A list ready for unmix():
  \item{data_list}{Named list of data matrices}
  \item{data_types}{Named character vector of data types}
  \item{samples}{Common sample names (aligned)}
  \item{metadata}{List with preprocessing details for each block}
}
\description{
Convenience function to prepare multiple data blocks at once.
Combines KDE, point counting, and compositional data preparation with
alignment checking. Supports multiple blocks of the same type via named lists.
}
\examples{
\dontrun{
# Example 1: Single block per type
prepared <- prepare_data_blocks(
  kde_raw = my_dz_ages,
  point_counting_raw = my_mineral_counts,
  kde_vars = c("age_concordia", "ti_temp"),
  point_counting_vars = c("Qtz", "Fsp", "Lith", "Musc"),
  n_points_kde = 129
)

# Example 2: Multiple KDE blocks
prepared <- prepare_data_blocks(
  kde_raw = list(
    Zircon = zircon_ages,
    Apatite = apatite_ages
  ),
  kde_vars = list(
    Zircon = c("age_concordia", "ti_temp"),
    Apatite = c("age_u_pb", "age_fission_track")
  )
)

# Example 3: Multiple compositional blocks
prepared <- prepare_data_blocks(
  compositional_raw = list(
    MajorOxides = major_oxides,
    TraceElements = trace_elements,
    ModalMin = modal_mineralogy
  ),
  compositional_vars = list(
    MajorOxides = c("SiO2", "Al2O3", "FeO", "MgO"),
    TraceElements = c("Zr", "Y", "Nb", "La", "Ce"),
    ModalMin = c("Qtz", "Fsp", "Mica", "Amph")
  ),
  apply_clr_compositional = TRUE
)

# Example 4: Mixed - 2 KDE + 3 Compositional
prepared <- prepare_data_blocks(
  kde_raw = list(
    Zircon = zircon_ages,
    Apatite = apatite_ages
  ),
  compositional_raw = list(
    MajorOxides = major_oxides,
    TraceElements = trace_elements,
    ModalMin = modal_mineralogy
  ),
  kde_vars = list(
    Zircon = c("age_concordia"),
    Apatite = c("age_u_pb")
  ),
  compositional_vars = list(
    MajorOxides = c("SiO2", "Al2O3", "FeO"),
    TraceElements = c("Zr", "Y", "Nb"),
    ModalMin = c("Qtz", "Fsp", "Mica")
  )
)

# Unmix directly
result <- unmix(
  data_list = prepared$data_list,
  data_types = prepared$data_types,
  K = 3
)
}

}
