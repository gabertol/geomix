% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/provenance_unmix.R
\name{unmix}
\alias{unmix}
\title{Coupled Unmixing with Multiple Data Types}
\usage{
unmix(
  data_list,
  data_types = NULL,
  K,
  max_iter = 2000,
  tol = 1e-08,
  eta_A = 1,
  seed = 123,
  verbose = FALSE
)
}
\arguments{
\item{data_list}{Named list of data matrices. Each matrix should have samples
as rows and features as columns. Names will be used to identify data blocks.}

\item{data_types}{Named character vector specifying the type of each data block.
Options: "continuous" (default, e.g., KDE-discretized ages),
"compositional" (e.g., mineral counts - will apply CLR transformation),
"clr" (already in CLR space).}

\item{K}{Integer, number of sources (end-members) to unmix.}

\item{max_iter}{Maximum number of iterations (default: 2000).}

\item{tol}{Convergence tolerance for relative change in loss (default: 1e-8).}

\item{eta_A}{Step size for updating A (default: 1.0, full update).}

\item{seed}{Random seed for reproducibility (default: 123).}

\item{verbose}{Logical, print progress? (default: FALSE).}
}
\value{
A list of class "unmix_result" containing:
  \item{A}{Mixing matrix (N x K), rows sum to 1}
  \item{B_list}{List of source signature matrices (K x F_i for each block)}
  \item{recon_list}{List of reconstructed data matrices}
  \item{data_types}{Character vector of data types used}
  \item{loss}{Final loss value}
  \item{loss_history}{Vector of loss at each iteration}
  \item{iters}{Number of iterations performed}
  \item{converged}{Logical, did algorithm converge?}
  \item{call}{The matched call}
}
\description{
Performs simultaneous unmixing of multiple data blocks (e.g., detrital zircon
ages, bulk petrology, heavy minerals) using non-negative least squares (NNLS)
with appropriate transformations for each data type.
}
\examples{
\dontrun{
# Simulate data
N <- 50  # samples
K <- 3   # sources

# Continuous data (e.g., detrital zircon ages)
DZ <- matrix(rnorm(N * 100), N, 100)

# Compositional data (e.g., mineral counts)
BP_counts <- matrix(rpois(N * 10, lambda = 20), N, 10)

# Unmix
result <- unmix(
  data_list = list(DZ = DZ, BP = BP_counts),
  data_types = c(DZ = "continuous", BP = "compositional"),
  K = 3
)

# Examine results
print(result)
plot(result)
}

}
